<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpongeScript Search</title>
    <style>
        /* Define CSS classes for background color rotation */
        .pink-bg { background-color: pink; }
        .yellow-bg { background-color: yellow; }
        .brown-bg {
            background-color: brown;
            color: white;
        }
        .result {
            margin: 0;
            padding: 5px;
            line-height: 1.5;
        }
        .file-link {
            text-decoration: none;
            color: black;
            font-weight: bold;
            font-size: 15pt;
            font-family: Helvetica;
        }
        .progress-bar {
            width: 100%;
            background-color: #f3f3f3;
        }
        .progress-bar-inner {
            width: 0;
            height: 30px;
            background-color: #4caf50;
            text-align: center;
            line-height: 30px;
            color: white;
        }
    </style>
</head>
<body style="position:relative;top:-22px; min-height:100%;">
    <h1 style="background-color:#fcf590;text-align:center;font-family:Arial;"><a style="text-decoration:none;color:black;" href="index.html"><img src="sponge.png"/> SpongeScript<img src="scroll.png"/></a></h1>
	<div style="text-align:center;font-size:11px;background-color:pink;height:23px;position:relative;top:-22px;"class="navbar">
<h2 style="position:relative;font-family:arial;top:3px;"><a style="color:black;text-decoration:none;" href="/SpongeScript/index.html">Home</a> | <a style="text-decoration:none;color:black;" href="/SpongeScript/about.html">About</a> | <a style="text-decoration:none;color:black;" href="/SpongeScript/author.html">Author</a> | <a style="text-decoration:none;color:black;" href="/SpongeScript/resources.html">Resources</a> | <a style="text-decoration:none;color:black;" href="/SpongeScript/scripts">Scripts</a></h2>
</div>
<div style="float:right;text-align:center;font-size:8px;background-color:#70cbff;height:20px;position:relative;top:-22px;width:138px;"class="datetime">
<h2 style="position:relative;font-family:arial;top:-8px;">Upd. 10/22/2023-9:32pm</h2></div>
<h3 style="font-family:Arial;">SpongeScript Search</h3>

    <!-- Input box for searching with increased size -->
    <input type="text" id="searchInput" placeholder="Enter keyword or phrase" style="width: 300px; margin-right: 10px;">
    <button onclick="searchHTMLFiles()">Search</button>
    <div class="progress-bar">
        <div class="progress-bar-inner">0%</div>
    </div>

    <!-- Container for displaying results -->
    <div id="results"></div>

    <script>
        // List of HTML files (replace with your own file URLs)
        const files = [
           's01/e01',
's01/e02',
's01/e03',
's01/e04',
's01/e05',
's01/e06',
's01/e07',
's01/e08',
's01/e09',
's01/e10',
's01/e11',
's01/e12',
's01/e13',
's01/e14',
's01/e15',
's01/e16',
's01/e17',
's01/e18',
's01/e19',
's01/e20',
's01/e21',
's01/e22',
's01/e23',
's01/e24',
's01/e25',
's01/e26',
's01/e27',
's01/e28',
's01/e29',
's01/e30',
's01/e31',
's01/e32',
's01/e33',
's01/e34',
's01/e35',
's01/e36',
's01/e37',
's01/e38',
's01/e39',
's01/e40',
's01/e41',
's02/e01',
's02/e02',
's02/e03',
's02/e04',
's02/e05',
's02/e06',
's02/e07',
's02/e08',
's02/e09',
's02/e10',
's02/e11',
's02/e12',
's02/e13',
's02/e14',
's02/e15',
's02/e16',
's02/e17',
's02/e18',
's02/e19',
's02/e20',
's02/e21',
's02/e22',
's02/e23',
's02/e24',
's02/e25',
's02/e26',
's02/e27',
's02/e28',
's02/e29',
's02/e30',
's02/e31',
's02/e32',
's02/e33',
's02/e34',
's02/e35',
's02/e36',
's02/e37',
's02/e38',
's02/e39',
's03/e01',
's03/e02',
's03/e03',
's03/e04',
's03/e05',
's03/e06',
's03/e07',
's03/e08',
's03/e09',
's03/e10',
's03/e11',
's03/e12',
's03/e13',
's03/e14',
's03/e15',
's03/e16',
's03/e17',
's03/e18',
's03/e19',
's03/e20',
's03/e21',
's03/e22',
's03/e23',
's03/e24',
's03/e25',
's03/e26',
's03/e27',
's03/e28',
's03/e29',
's03/e30',
's03/e31',
's03/e32',
's03/e33',
's03/e34',
's03/e35',
's03/e36',
's03/e37',
's04/e01',
's04/e02',
's04/e03',
's04/e04',
's04/e05',
's04/e06',
's04/e07',
's04/e08',
's04/e09',
's04/e10',
's04/e11',
's04/e12',
's04/e13',
's04/e14',
's04/e15',
's04/e16',
's04/e17',
's04/e18',
's04/e19',
's04/e20',
's04/e21',
's04/e22',
's04/e23',
's04/e24',
's04/e25',
's04/e26',
's04/e27',
's04/e28',
's04/e29',
's04/e30',
's04/e31',
's04/e32',
's04/e33',
's04/e34',
's04/e35',
's04/e36',
's04/e37',
's04/e38',
's05/e01',
's05/e02',
's05/e03',
's05/e04',
's05/e05',
's05/e06',
's05/e07',
's05/e08',
's05/e09',
's05/e10',
's05/e11',
's05/e12',
's05/e13',
's05/e14',
's05/e15',
's05/e16',
's05/e17',
's05/e18',
's05/e19',
's05/e20',
's05/e21',
's05/e22',
's05/e23',
's05/e24',
's05/e25',
's05/e26',
's05/e27',
's05/e28',
's05/e29',
's05/e30',
's05/e31',
's05/e32',
's05/e33',
's05/e34',
's05/e35',
's05/e36',
's05/e37',
's05/e38',
's05/e39',
's05/e40',
's05/e41',
's06/e01',
's06/e02',
's06/e03',
's06/e04',
's06/e05',
's06/e06',
's06/e07',
's06/e08',
's06/e09',
's06/e10',
's06/e11',
's06/e12',
's06/e13',
's06/e14',
's06/e15',
's06/e16',
's06/e17',
's06/e18',
's06/e19',
's06/e20',
's06/e21',
's06/e22',
's06/e23',
's06/e24',
's06/e25',
's06/e26',
's06/e27',
's06/e28',
's06/e29',
's06/e30',
's06/e31',
's06/e32',
's06/e33',
's06/e34',
's06/e35',
's06/e36',
's06/e37',
's06/e38',
's06/e39',
's06/e40',
's06/e41',
's06/e42',
's06/e43',
's06/e44',
's06/e45',
's06/e46',
's07/e01',
's07/e02',
's07/e03',
's07/e04',
's07/e05',
's07/e06',
's07/e07',
's07/e08',
's07/e09',
's07/e10',
's07/e11',
's07/e12',
's07/e13',
's07/e14',
's07/e15',
's07/e16',
's07/e17',
's07/e18',
's07/e19',
's07/e20',
's07/e21',
's07/e22',
's07/e23',
's07/e24',
's07/e25',
's07/e26',
's07/e27',
's07/e28',
's07/e29',
's07/e30',
's07/e31',
's07/e32',
's07/e33',
's07/e34',
's07/e35',
's07/e36',
's07/e37',
's07/e38',
's07/e39',
's07/e40',
's07/e41',
's07/e42',
's07/e43',
's07/e44',
's07/e45',
's07/e46',
's07/e47',
's07/e48',
's07/e49',
's07/e50',
's08/e01',
's08/e02',
's08/e03',
's08/e04',
's08/e05',
's08/e06',
's08/e07',
's08/e08',
's08/e09',
's08/e10',
's08/e11',
's08/e12',
's08/e13',
's08/e14',
's08/e15',
's08/e16',
's08/e17',
's08/e18',
's08/e19',
's08/e20',
's08/e21',
's08/e22',
's08/e23',
's08/e24',
's08/e25',
's08/e26',
's08/e27',
's08/e28',
's08/e29',
's08/e30',
's08/e31',
's08/e32',
's08/e33',
's08/e34',
's08/e35',
's08/e36',
's08/e37',
's08/e38',
's08/e39',
's08/e40',
's08/e41',
's08/e42',
's08/e43',
's08/e44',
's08/e45',
's08/e46',
's08/e47',
        ];

        // Function to load and search HTML files
        async function searchHTMLFiles() {
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '';

            let colorClassIndex = 0;
            let progress = 0;
            const progressBar = document.querySelector('.progress-bar-inner');
            progressBar.style.width = '0%';

            for (const file of files) {
                const response = await fetch(file);
                const htmlContent = await response.text();

                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlContent, 'text/html');

                const text = doc.body.textContent.toLowerCase();
                const index = text.indexOf(searchQuery);

                if (index !== -1) {
                    const startIndex = Math.max(0, index - 100);
                    const endIndex = Math.min(text.length, index + searchQuery.length + 10);

                    const surroundingText = text.substring(startIndex, endIndex);
                    const highlightedText = surroundingText.replace(
                        new RegExp(`(${searchQuery})`, 'gi'),
                        '<strong style="font-size: 16px; background-color: red; color: white;">$1</strong>'
                    );

                    const episodeNumber = file.match(/e(\d+)/)[1];
                    const seasonNumber = file.match(/s(\d+)/)[1];
                    const formattedFileName = `S${seasonNumber}/E${episodeNumber}`;

                    const colorClass = getColorClass(colorClassIndex++);
                    resultsContainer.innerHTML += `<p class="result ${colorClass}"><a href="javascript:void(0);" class="file-link" onclick="createHighlightedPage('${file}', '${searchQuery}')">${formattedFileName}</a>: ${highlightedText}</p>`;
                }

                // Update progress
                progress = ((files.indexOf(file) + 1) / files.length) * 100;
                progressBar.style.width = `${progress}%`;
                progressBar.textContent = `${Math.round(progress)}%`;
            }

            // Search is complete, reset progress bar
            progressBar.style.width = '0%';
        }

        // Function to create a new temporary HTML page with highlighted text
        function createHighlightedPage(file, searchQuery) {
            const windowName = 'highlightedPage';
            const newPage = window.open('', windowName, 'width=600,height=400');
            const url = file;

            fetch(url)
                .then((response) => response.text())
                .then((htmlContent) => {
                    const highlightedText = htmlContent.replace(
                        new RegExp(`(${searchQuery})`, 'gi'),
                        '<strong style="font-size: 15px; background-color: black; color: white;">$1</strong>'
                    );
                    newPage.document.open();
                    newPage.document.write(highlightedText);
                    newPage.document.close();
                });
        }

        // Function to rotate background colors
        function getColorClass(index) {
            const colors = ['pink-bg', 'yellow-bg', 'brown-bg'];
            return colors[index % colors.length];
        }
    </script>
</body>
</html>
